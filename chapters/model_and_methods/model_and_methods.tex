%! TeX root = ../../main.tex

\chapter{Model and methods}

\section{Hubbard model}

In this work we use the Hubbard model \cite{Hubbard1997} to describe strongly correlated systems.
Denoting the creator of site $i$ and spin $\sigma\in\{\uparrow,\downarrow\}$
as $d^\dag_{i\sigma}$ and respective annihilator as $d_{i\sigma}$ its Hamiltonian reads
\begin{equation}
    H
    =
    -t\sum_{\langle i j\rangle\sigma}
    (d^\dag_{i\sigma} d^{\pdag}_{j\sigma} + d^\dag_{j\sigma} d^{\pdag}_{i\sigma})
    +
    U\sum_{i\sigma} n_{i\uparrow} n_{i\downarrow}
    +
    (\epsilon - \mu)\sum_{i\sigma} n_{i\sigma},
\end{equation}
with a sketch given in \zcref{fig:hubbard-model}.
Each site can be occupied by up to two electrons.
The first term describes the kinetics of the system:
Electrons can hop between nearest-neighbors $\langle i j\rangle$
defining the hopping amplitude $t$.
If two electrons are on the same site, they are repulsed by the Coulomb interaction $U$
expressed by the second term (occupation $n_{i\sigma} = d^\dag_{i\sigma} d^{\pdag}_{i\sigma}$).
The last term describes the on-site energy $\epsilon$ and
chemical potential $\mu$ as we are in the grand canonical ensemble.

\begin{figure}[ht]
    \centering
    \input{graphics/tikz/hubbard_2d.tex}
    \caption{
        Hubbard model on a 2D square lattice.
        $t$ denotes hopping between nearest-neighbors,
        while $U$ describes the Coulomb repulsion on a doubly occupied site.
    }
    \label{fig:hubbard-model}
\end{figure}

Although the model looks simple, no analytical solution in arbitrary dimension exists.
The problem is that the kinetic part is diagonal in momentum space,
while the Coulomb interaction is diagonal in real space.
Thus, in DMFT (details in TODO) we instead solve a simpler model which has only one correlated site.
% TODO: reference DMFT

\section{Anderson impurity model}

The Hamiltonian of the Anderson impurity model \cite{Anderson1961} can be split into
an interacting and non-interacting part $H = H_0 + H_\mathrm{int}$.
Denoting the impurity annihilators by $d_\sigma$
and bath annihilators by $l_{i\sigma}$
it can be written as
\begin{align}
    H_0
     & =
    \sum_{\pk\sigma} (\epsilon_{d,\sigma} - \mu) d^\dag_{\pk\sigma} d^{\pdag}_{\pk\sigma}
    +
    \sum_{k\sigma} \epsilon_{k\sigma}^{\pdag} l^\dag_{k\sigma} l^{\pdag}_{k\sigma}
    +
    \sum_{k\sigma} \left(V^{\ps}_{k\sigma} d^\dag_{\vphantom{k}\sigma} l^{\pdag}_{k\sigma}
    + V_{k\sigma}^* l^\dag_{k\sigma} d^{\pdag}_{\vphantom{k}\sigma} \right),
    \\
    H_\mathrm{int}
     & =
    U n_\uparrow n_\downarrow.
\end{align}
Here,
$\epsilon_{d,\sigma}$ denotes the impurity energy,
$\mu$ the chemical potential,
$\epsilon_{k\sigma}$ the energy levels of the bath,
and $V_{k\sigma}$ the hybridization between the bath and impurity.
A graphical representation is given in \zcref{subfig:geometry-star}.

\begin{figure}[ht]
    \centering
    \savebox{\imagebox}{\input{graphics/tikz/geometry_star.tex}} % save for height alignment
    \begin{subfigure}{0.45\textwidth}
        \centering
        \usebox{\imagebox}
        \caption{star geometry}
        \label{subfig:geometry-star}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \centering
        \raisebox{\dimexpr0.5\ht\imagebox-0.5\height}
        {
            \input{graphics/tikz/geometry_natural_impurity_orbitals.tex}
        }
        \caption{natural impurity orbitals}
        \label{subfig:geometry-natural-impurity-orbitals}
    \end{subfigure}
    \caption{
        Anderson impurity model in different geometries.
        Impurity (square) interacting with bath sites (circle).
        Site occupation is indicated by fill level,
        where a full site corresponds to double occupation.
        Furthermore, hopping between sites is shown by lines.
        \subref{subfig:geometry-star} is the conventional ``star'' geometry;
        \subref{subfig:geometry-natural-impurity-orbitals} the natural impurity orbitals geometry
        (adapted from~\cite{Lu2019}).
    }
\end{figure}

\section{Lanczos algorithm}

The Lanczos algorithm \cite{Lanczos1950} can be used to approximate the extremal eigenvalues
of a hermitian $n\times n$ matrix.
In our case we are interested in the ground state and low energy excitations of a
given Hamiltonian $H$.
The method is especially useful if $H$ is sparse and too large to decompose fully.
It is based on a Krylov basis
\begin{equation}
    \mathcal{K}_m(H, \vec{q}) = \spn\{\vec{q}, H\vec{q}, H^2\vec{q}, \ldots, H^{m-1}\vec{q}\}
\end{equation}
for a given vector $\vec{q}$.
Typically, the value $m$ is very small compared to the matrix size: $m \ll n$.
Instead of a simple power iteration, the Lanczos algorithm is described by the
following recurrence relation
\begin{equation}
    b_j\vec{q}_{j+1} = H\vec{q}_j - a_j\vec{q}_j - b_{j-1}\vec{q}_{j-1}
    \label{eq:Lanczos-recurrence}
\end{equation}
with a normalized starting vector $\vec{q}_1$ and $\vec{q}_0 = \vec{0}$.
The coefficients are chosen such that each Lanczos vector $\vec{q}_j$ is orthonormal to each other
\begin{equation}
    a_j = \vec{q}_j^\dag H \vec{q}_j,
    \qquad
    b_j = \vec{q}_{j+1}^\dag H \vec{q}_j.
\end{equation}
For numerical stability \cite{Paige1972, Paige1976}
we instead calculate the coefficients as
\begin{equation}
    a_j = \vec{v}_j^\dag(H \vec{v}_j - \beta_{j-1}\vec{v}_{j-1}),
    \qquad
    b_j = \Vert H\vec{v}_j - \alpha\vec{v}_j -  \beta_{j-1}\vec{v}_{j-1} \Vert.
\end{equation}
From this relation we can create the tridiagonal matrix
\begin{equation}
    T
    =
    \begin{pmatrix}
        a_1 & b_1 &        &         &         \\
        b_1 & a_2 & b_2    &         &         \\
            & b_2 & a_3    & \ddots  &         \\
            &     & \ddots & \ddots  & b_{m-1} \\
            &     &        & b_{m-1} & a_m
    \end{pmatrix}
    \label{eq:tridiagonal-scalar}
\end{equation}
and matrix collecting all Lanczos vectors
\begin{equation}
    Q = (\vec{q}_1, \vec{q}_2, \ldots, \vec{q}_m).
\end{equation}
Then, \zcref{eq:Lanczos-recurrence} in matrix form can be rewritten as
\begin{equation}
    H Q = Q T + b_{m}\vec{q}_{m+1}\vec{e}_{m}^\top,
\end{equation}
where $\vec{e}_m$ is the Euclidean basis vector with $m$-th component 1 and all other 0.
Rearraning gives
\begin{equation}
    T = Q^\dag H Q,
\end{equation}
which means that $T$ is the orthogonal projection of $H$ onto
the subspace $\mathcal{K}_m(H, \vec{q}_1)$ \cite{Cullum1985}.

\subsection{Block Lanczos}

Instead of calculating only one vector $\vec{q}_j$ in each step,
one can calculate $p$ vectors simultaneously.
We define
\begin{equation}
    Q_1 = (\vec{q}_1^{(1)}, \vec{q}_1^{(2)}, \ldots, \vec{q}_1^{(p)})
\end{equation}
to be an $n\times p$ orthonormal block of starting vectors
and $Q_0 = \mathbb{0}_{n\times q}$.
Then the recurrence relation (\zcref{eq:Lanczos-recurrence}) can be rewritten as
\begin{equation}
    Q_{j+1} B_j = H Q_j - Q_j A_j - Q_{j-1} B_{j-1}^\dag,
    \label{eq:block-Lanczos-recurrence}
\end{equation}
with $A_j$, $B_j$ matrices of size $p\times p$ chosen such that each block $Q_j$ is orthonormal
to each other.
The block tridiagonal matrix of size $mp\times mp$ is written as
\begin{equation}
    T
    =
    \begin{pmatrix}
        A_1 & B_1^\dag &          &         &              \\
        B_1 & A_2      & B_2^\dag &         &              \\
            & B_2      & A_3      & \ddots  &              \\
            &          & \ddots   & \ddots  & B_{m-1}^\dag \\
            &          &          & B_{m-1} & A_m
    \end{pmatrix}.
    \label{eq:tridiagonal-block}
\end{equation}
For the calculation for $B_j$ one needs to orthornormalize
\begin{equation}
    \tilde Q_{j+1} = H Q_j - Q_j A_j - Q_{j-1} B_{j-1}^\dag,
\end{equation}
which is not unique.
For instance, a QR decomposition $Q_{j+1} B_j = \tilde Q_{j+1}$
results in an upper triangular matrix $B_j$ which gives $T$ a compactly banded structure
\cite{Cullum1985, Golub2013}.
In our work however, we use symmetric LÃ¶wdin orthonormalization \cite{Lowdin1950, Brass2021}
which is based on the singular value decomposition
$\tilde Q_{j+1} = U_{j+1} \Sigma_{j+1} V_{j+1}^\dag$.
We define the overlap matrix as
\begin{equation}
    S_{j+1} \coloneqq \tilde Q_{j+1}^\dag \tilde Q_{j+1} = V_{j+1} \Sigma_{j+1}^2 V_{j+1}^\dagger
\end{equation}
and its roots as
\begin{equation}
    S_{j+1}^{1/2}  = V_{j+1} \Sigma_{j+1} V_{j+1}^\dagger,
    \qquad
    S_{j+1}^{-1/2} = V_{j+1} \Sigma_{j+1}^{-1} V_{j+1}^\dagger.
\end{equation}
The resulting vectors are then
\begin{align}
    Q_{j+1} & = \tilde Q_{j+1} S_{j+1}^{-1/2} \qquad \text{and} \\
    B_j     & = S_{j+1}^{1/2}.
\end{align}
We use this method as it guarantees hermiticity in the off-diagonal blocks $B_j^\dag = B_j$
albeit losing the compactly banded structure for $T$.
If $\tilde Q_j$ is rank-deficient,
this method can still be applied \cite{Brass2021} by ignoring the block of vanishing singular values
\begin{equation}
    \Sigma =
    \begin{pmatrix}
        \Sigma_i \neq 0 & 0 \\
        0               & 0
    \end{pmatrix}
    \qquad
    \Sigma^{-1} =
    \begin{pmatrix}
        \Sigma_i^{-1} & 0 \\
        0             & 0
    \end{pmatrix},
\end{equation}
still guaranteeing orthonormality against previous states $Q_i^\dag Q_j = \mathbb{0}_{q\times q}$
for $i \in \{1,\ldots,j-1\}$ \cite{Golub2013}.

\section{Correlators}

The retarded correlator for two fermionic operators $A, B$ is defined as
\begin{align}
    C(t) = -\mi \Theta(t) \langle\{A(t), B\}\rangle,
\end{align}
with the step function $\Theta$ and anticommutator $\{\cdot,\cdot\}$.
$A(t) = \me^{\mi H t} A \me^{-\mi H t}$ is given in the Heisenberg picture.
At zero temperature $T=0$, the expectation value is evaluated on the ground state
$\langle\cdot\rangle = \langle\psi_0 | \cdot | \psi_0\rangle$ only.
Following the notation of \cite{Bulla1998,Kugler2022},
we will denote the Fourier transform $\mathcal{F}$ as
\begin{equation}
    C_\omega
    =
    \mathcal{F}[C(t)]
    \coloneq
    \lim_{\delta\to0^+}
    \int_{-\infty}^\infty\! \md t\> \me^{\mi (\omega + \mi\delta) t} C(t)
    \eqcolon
    \lAngle A, B\rAngle_\omega.
\end{equation}
Furthermore,
we split this expression into two components $C_\omega = C^+_\omega + C^-_\omega$ with
\begin{subequations}
    \begin{align}
        C^+_\omega
         & =
        \left\langle A \frac{1}{\omega - H + E_0} B\right\rangle
        =
        \sum_n \frac{\langle\psi_0 | A | n\rangle\langle n | B | \psi_0\rangle}{\omega - E_n + E_0}, \\
        C^-_\omega
         & =
        \left\langle B \frac{1}{\omega + H - E_0} A\right\rangle
        =
        \sum_n \frac{\langle\psi_0 | B | n\rangle\langle n | A | \psi_0\rangle}{\omega + E_n - E_0}.
    \end{align}
\end{subequations}
The sum is over a complete basis $H|n\rangle = E_n|n\rangle$ with ground state energy $E_0$.
A derivation is given in \zcref{app:fourier-transform}.
The problem however is the exponential algorithmic complexity:
For $N$ sites (bath and impurity), the number of all possible states scales as $O(4^N)$
limiting exact diagonalization (ED) to $N=O(10)$ sites.

For the choice $A=d_\sigma, B=d_\sigma^\dag$ the correlator describes
the propagation of an electron/hole in the system and is called Green's function $G_\omega$.

\subsection{Representation}

Using the Lanczos algorithm we can represent correlators as the $(1,1)$ component of the inverse
of our tridiagonal matrix $T$ \cite{Lu2014}, see \zcref{eq:tridiagonal-scalar,eq:tridiagonal-block}

\begin{subequations}
    \begin{align}
        C_\omega
         & =
        \frac{b_0^2}{\omega + \mi0^+ - a_1 - \frac{b_1^2}{\omega + \mi0^+ - a_2 - \ldots}}
        \qquad
         &
         & \text{(scalar)},                                                                         \\
        C_\omega
         & = B_0\frac{1}{\omega + \mi0^+ - A_1 - B_1\frac{1}{\omega + \mi0^+ - A_2 - \ldots}B_1}B_0
        \qquad
         &
         & \text{(block)}.
    \end{align}
\end{subequations}
In the block case $\frac{1}{D} \wedgeq D^{-1}$ is meant as the matrix inverse
and $\omega + \mi0^+ \wedgeq (\omega + \mi0^+)\mathbb{1}$ a shorthand notation
for a diagonal matrix.
In contrast to \texttt{QUANTY} \cite{Ackermann2024} we always keep our matrices $B_i$ hermitian,
even if they are rank-deficient.
We will call this the ``continued fraction'' representation.

Diagonalizing $T$ gives us a sum of poles instead:
\begin{subequations}
    \begin{align}
        C_\omega
         & =
        \sum_{i=1}^m \frac{w_i}{\omega + \mi0^+ - \epsilon_i}
        \qquad
         &   & \text{(scalar)}, \\
        C_\omega
         & =
        \sum_{i=1}^m \frac{W_i}{\omega + \mi0^+ - \epsilon_i}
        \qquad
         &   & \text{(block)}.
    \end{align}
\end{subequations}

Only diagonalizing from the second part of $T$ onwards gives us the ``Anderson representation''
\begin{subequations}
    \begin{align}
        C_\omega
         & =
        \frac{b_0^2}{\omega + \mi0^+ - a_1 - \sum_{j=2}^m \frac{w_j}{\omega + \mi0^+ - \epsilon_j}}
        \qquad
         &
         &
        \text{(scalar)},                                                                                   \\
        C_\omega
         & = B_0\frac{1}{\omega + \mi0^+ - A_1 - \sum_{j=2}^m \frac{W_j}{\omega + \mi0^+ - \epsilon_j}}B_0
        \qquad
         &
         &
        \text{(block)}.
    \end{align}
\end{subequations}
A detailed explanation on how to switch between these representations is given in \cite{Lu2014}.

\subsection{Broadening}

Given a correlator $C_\omega$ the corresponding spectral part is defined as
\begin{equation}
    A_\omega \coloneq -\frac{1}{\muppi}\Im C_\omega,
\end{equation}
giving
\begin{subequations}
    \begin{align}
        A^+_\omega
         & =
        \sum_n \langle\psi_0 | A | n\rangle\langle n | B | \psi_0\rangle \delta(\omega - E_n + E_0),
        \label{eq:spectral-part-plus} \\
        A^-_\omega
         & =
        \sum_n \langle\psi_0 | B | n\rangle\langle n | A | \psi_0\rangle \delta(\omega + E_n - E_0).
        \label{eq:spectral-part-minus}
    \end{align}
\end{subequations}

The real and imaginary part of a correlator are not independent
but related by Kramers-Kronig transformations (Hilbert transform)
\begin{subequations}
    \begin{align}
        \Re C_\omega
         & =
        - \frac{1}{\muppi} \mathcal{P}\! \int_{-\infty}^\infty\! \md\omega'
        \frac{\Im C_{\omega'}}{\omega - \omega'}
        \label{eq:kramers-kroneg-real} \\
        \Im C_\omega
         & =
        \phantom{-} \frac{1}{\muppi} \mathcal{P}\! \int_{-\infty}^\infty\! \md\omega'
        \frac{\Re C_{\omega'}}{\omega - \omega'}.
        \label{eq:kramers-kronig-imag}
    \end{align}
\end{subequations}

Thus, we can broaden our delta-peaks from \zcref{eq:spectral-part-plus, eq:spectral-part-minus}
for the imaginary part and obtain the real part through \zcref{eq:kramers-kroneg-real}.
We will denote the broadened correlator as $C_z$
to contrast it to $C_\omega$, which has no broadening.
In this work we will use one of the following three schemes:
\begin{enumerate}[(i)]
    \item Lorentzian broadening characterized by $\delta$:
          \label{item:lorentzian}
          \begin{equation}
              \delta(\omega - \omega_0)
              \longrightarrow
              \frac{1}{\muppi}\frac{\delta}{(\omega - \omega_0)^2 + \delta^2}
          \end{equation}
    \item Gaussian broadening characterized by $\sigma$:
          \label{item:gaussian}
          \begin{equation}
              \delta(\omega - \omega_0)
              \longrightarrow
              \frac{1}{\sqrt{2\muppi \sigma^2}}\exp\left(-\frac{(\omega - \omega_0)^2}{2\sigma^2}\right)
          \end{equation}
    \item logarithmic Gaussian characterized by $b$ \cite{Bulla2008}:
          \label{item:logarithmic-gaussian}
          \begin{equation}
              \delta(\omega - \omega_0)
              \longrightarrow
              \Theta(\omega\omega_0)\frac{\me^{-b^2/4}}{b\omega\sqrt{\muppi}}\exp\left(-\frac{(\ln\omega-\ln\omega_0)^2}{b^2}\right)
          \end{equation}
\end{enumerate}

\section{Natural impurity orbitals}

natural impurity orbitals
Hybridization function
\begin{align}
    \Delta_\omega = \sum_{k\sigma} \frac{|V_{k\sigma}|^2}{\omega - \epsilon_{k\sigma}}
\end{align}

\section{Self-energy}

Dyson equation
\begin{equation}
    \Sigma_\omega = (G_{0, \omega})^{-1} - (G_\omega)^{-1}
\end{equation}
four correlators
\begin{subequations}
    \begin{alignat}{2}
        G_\omega
         & =
        \lAngle d^{\pdag}_\sigma, d_{\sigma}^\dag\rAngle_\omega,
         &
        \qquad
        I_\omega
         & =
        \lAngle q^{\pdag}_\sigma, q_{\sigma}^\dag\rAngle_\omega \\
        F^\mL_\omega
         & =
        \lAngle q^{\pdag}_\sigma, d_{\sigma}^\dag\rAngle_\omega,
         &
        \qquad
        F^\mR_\omega
         & =
        \lAngle d^{\pdag}_\sigma, q_{\sigma}^\dag\rAngle_\omega
    \end{alignat}
\end{subequations}
calculate self-energy as
\begin{equation}
    \Sigma^\mIFG_\omega
    =
    \Sigma^\mH + I_\omega - F^\mL_\omega (G_\omega)^{-1} F^\mR_\omega
\end{equation}
calculate block correlator as

\begin{subequations}
    \begin{align}
        C^+_\omega
         & =
        \biggl\langle \psi_0 \biggr|
        \begin{pmatrix}
            q^{\pdag}_\sigma \\
            d^{\pdag}_\sigma
        \end{pmatrix}
        \frac{1}{\omega - H + E_0}
        \begin{pmatrix}
            q^\dag_\sigma & d^\dag_\sigma
        \end{pmatrix}
        \biggl| \psi_0 \biggr\rangle
        =
        \begin{pmatrix}
            I^+_\omega      & F^{\mL+}_\omega \\
            F^{\mR+}_\omega & G^+_\omega
        \end{pmatrix} \\
        C^-_\omega
         & =
        \biggl\langle \psi_0 \biggr|
        \begin{pmatrix}
            q^\dag_\sigma \\
            d^\dag_\sigma
        \end{pmatrix}
        \frac{1}{\omega + H - E_0}
        \begin{pmatrix}
            q^{\pdag}_\sigma & d^{\pdag}_\sigma
        \end{pmatrix}
        \biggl| \psi_0 \biggr\rangle
        =
        \begin{pmatrix}
            I^-_\omega      & F^{\mR-}_\omega \\
            F^{\mL-}_\omega & G^-_\omega
        \end{pmatrix}
    \end{align}

    starting wave function singlet
    \begin{equation}
        |\psi_s\rangle
        =
        \frac{1}{\sqrt{2}}
        (d^\dag_\uparrow c^\dag_{b\downarrow} - d^\dag_\downarrow c^\dag_{b\uparrow})
        \prod_{k\sigma} v^\dag_{k\sigma}
        |0\rangle
    \end{equation}
\end{subequations}

\section{DMFT}

\section{Bethe lattice}

\section{Configuration interaction}
