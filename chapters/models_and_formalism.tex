%! TeX root = ../main.tex

\chapter{Models and formalism}%
\label{ch:models-and-formalism}

\section{Bethe lattice}%
\label{sec:bethe-lattice}

In solid-states physics we study crystals in which atoms are periodically arranged in a lattice.
Given a set of basis vectors $\{\vec{a}_i\}$,
the lattice is periodic for all translations
\begin{equation}
    \vec{R} = \sum_i n_i \vec{a}_i
\end{equation}
for any integer $n_i \in \mathbb{Z}$.

In this work however,
we look at the Bethe lattice which is only characterized by a single quantity:
the coordination number $z$.
It is an infinite graph where each vertex is connected to $z$ neighbors\footnote{
    It is a lattice in the sense that a translation shifts the root node which is set arbitrarily.
}.
A sketch for $z=3$ is given in \zcref{subfig:bethe-lattice}:
We choose the black vertex in the center as the root node.
It is connected to three nodes (marked in blue) which in turn are also connected
to three nodes (each blue node is connected to the original black node and two red nodes).
This scheme is then infinitely repeated for each site.

We can then model electron movement as hopping from a given site to
one of the $z$ neighbors.
If we assume that hopping to each neighbor is equally likely and assign it the probability $p^*$,
the total probability of movement is $p = zp^*$.
In the limit of infinite connectivity $z\to\infty$ (infinite dimensions) this will diverge,
necessitating a renormalization.
Thus, the probability is rescaled as $p^* \to p^*/z$ such that
the total probability $p$ stays finite.
Instead of working with a hopping probability,
we instead introduce the hopping amplitude $t^* = t/\sqrt{z}$~\cite{Held2007}
which is sketched in \zcref{subfig:bethe-lattice}.
The density of states (DOS) for $z\to\infty$ then reads
\begin{equation}
    \rho(\omega) = \frac{1}{2\muppi t^2} \sqrt{4t^2 - \omega^2},
\end{equation}
with bandwidth $W=4t$.
This equation\footnote{
    This distribution is also known as the Wigner semicircle distribution
    which is the eigenvalue distribution of random matrices.
    They are related to the DOS in as much as a random walk on the Bethe lattice.
    As the graph has no closed loops,
    a particle must necessarily take the same path back to return to its origin.
    Further information can be found in the literature under \emph{random matrix theory}.
}
is commonly written using the half-bandwidth $D = W/2 = 2t$:
\begin{equation}
    \rho(\omega) = \frac{2}{\muppi D^2} \sqrt{D^2 - \omega^2},
    \label{eq:dos-semicircle}
\end{equation}
which is shown in \zcref{subfig:bethe-density}.

\begin{figure}[ht]
    \centering
    \begin{subfigure}{0.45\textwidth}
        \centering
        \input{graphics/tikz/bethe_lattice.tex}
        \caption{}%
        \label{subfig:bethe-lattice}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \centering
        \input{graphics/tikz/bethe_density.tex}
        \caption{}%
        \label{subfig:bethe-density}
    \end{subfigure}
    \caption{
        \subref{subfig:bethe-lattice}
        Bethe lattice with coordination number $z=3$ and hopping amplitude $t^*$.
        \subref{subfig:bethe-density}
        DOS in infinite dimensions.
        \fe{TODO: align sub figures?} %TODO: align subfigures? % chktex 13
    }
\end{figure}

\section{Hubbard model}%
\label{sec:hubbard-model}

In this work we use the Hubbard model~\cite{Hubbard1997} to describe strongly correlated systems.
Denoting the creator of site $i$ and spin $\sigma\in\{\uparrow,\downarrow\}$
as $d^\dag_{i\sigma}$ and respective annihilator as $d_{i\sigma}$ its Hamiltonian\footnote{
    In this work we look at the SU(2) symmetric model % chktex 36
    which means that $\epsilon_\uparrow = \epsilon_\downarrow$.
    For simplicity, we omit the spin index and just write $\epsilon$.
}
reads
\begin{equation}
    H
    =
    -t\sum_{\langle i j\rangle\sigma}
    (d^\dag_{i\sigma} d^{\pdag}_{j\sigma} + d^\dag_{j\sigma} d^{\pdag}_{i\sigma})
    +
    U\sum_i n_{i\uparrow} n_{i\downarrow}
    +
    (\epsilon - \mu)\sum_{i\sigma} n_{i\sigma},
    \label{eq:hubbard}
\end{equation}
with a sketch given in \zcref{fig:hubbard-model}.
Each site can be occupied by up to two electrons.
The first term describes the kinetics of the system:
Electrons can hop between nearest-neighbors $\langle i j\rangle$
defining the hopping amplitude $t$.
If two electrons are on the same site, they are repulsed by the Coulomb interaction $U$
expressed by the second term (occupation $n_{i\sigma} = d^\dag_{i\sigma} d^{\pdag}_{i\sigma}$).
The last term describes the on-site energy $\epsilon$ and
chemical potential $\mu$ as we are in the grand canonical ensemble.

\begin{figure}[ht]
    \centering
    \input{graphics/tikz/hubbard_2d.tex}
    \caption{
        Hubbard model on a 2D square lattice.
        $t$ denotes hopping between nearest-neighbors,
        while $U$ describes the Coulomb repulsion on a doubly occupied site.
    }%
    \label{fig:hubbard-model}
\end{figure}

Although the model looks simple, no analytical solution in arbitrary dimension exists.
The problem is that the kinetic part is diagonal in momentum space,
while the Coulomb interaction is diagonal in real space.
Thus, in DMFT (details in \zcref{sec:dmft}) we instead solve a simpler model which has only one correlated site.
% TODO: reference DMFT

\section{Anderson impurity model}%
\label{sec:anderson-impurity-model}

The Hamiltonian of the Anderson impurity model~\cite{Anderson1961} can be split into
an interacting and non-interacting part
\begin{equation}
    H = H_0 + H_\mathrm{int}.
    \label{eq:impurity-Hamiltonian}
\end{equation}
Denoting the impurity (labeled $i$) annihilators by $d_\sigma$
and bath (labeled $b$) annihilators by $b_{k\sigma}$
it can be written as
\begin{align}
    H_0
     & =
    (\epsilon - \mu) \sum_{\pk\sigma} n_\sigma
    +
    \sum_{k\sigma} \epsilon_{k\sigma}^{\pdag} b^\dag_{k\sigma} b^{\pdag}_{k\sigma}
    +
    \sum_{k\sigma} \left(V^{\ps}_{k\sigma} d^\dag_{\pk\sigma} b^{\pdag}_{k\sigma}
    + V_{k\sigma}^* b^\dag_{k\sigma} d^{\pdag}_{\pk\sigma} \right),
    \label{eq:anderson-non-interacting}
    \\
    H_\mathrm{int}
     & =
    U n_\uparrow n_\downarrow.
    \label{eq:anderson-interaction}
\end{align}
Here,
$\epsilon$ denotes the impurity energy,
$\mu$ the chemical potential,
$n_\sigma = d^\dag_\sigma d^{\pdag}_\sigma$ the impurity occupation,
$\epsilon_{k\sigma}$ the energy levels of the bath,
and $V_{k\sigma}$ the hybridization between the bath and impurity.
A graphical representation of this \emph{star geometry} is given in \zcref{subfig:geometry-star}:
each bath site has a given filling
and electrons from each bath site can hop in and out of the impurity.

\begin{figure}[ht]
    \centering
    \savebox{\imagebox}{\input{graphics/tikz/geometry_star.tex}} % save for height alignment
    \begin{subfigure}{0.45\textwidth}
        \centering
        \usebox{\imagebox}
        \caption{}%
        \label{subfig:geometry-star}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \centering
        \raisebox{\dimexpr0.5\ht\imagebox-0.5\height}
        {
            \input{graphics/tikz/geometry_natural_impurity_orbitals.tex}
        }
        \caption{}%
        \label{subfig:geometry-natural-impurity-orbitals}
    \end{subfigure}
    \caption{
        Anderson impurity model in different geometries.
        Impurity (square) interacting with bath sites (circles).
        Site occupation is indicated by fill level,
        where a full site corresponds to double occupation.
        Furthermore, hopping between sites is shown by lines.
        \subref{subfig:geometry-star} is the conventional \emph{star geometry};
        \subref{subfig:geometry-natural-impurity-orbitals} the \emph{natural impurity orbitals}
        are explained in \zcref{sec:natural-impurity-orbitals}
        (adapted from~\cite{Lu2019}).
    }
\end{figure}

\subsection{Natural impurity orbitals}%
\label{sec:natural-impurity-orbitals}

To solve the Anderson impurity model,
we can use Slater determinants to decompose the wave function
\begin{equation}
    \ket{\psi} = \sum_{i=1}^M \alpha_i \ket{\alpha_i}
    \label{eq:slater-decomposition}
\end{equation}
using any orthonormal set of basis functions.
With the occupation number,
we can express the number of electrons in each spin sector as
the sum of impurity and bath electrons
\begin{equation}
    N_\sigma = n_{i,\sigma} + \sum_{k=1}^N n_{b,k\sigma}.
\end{equation}
For a fixed amount of electrons $N_\mathrm{tot} = N_\uparrow + N_\downarrow$,
a combination of
\begin{equation}
    M = \binom{N+1}{n_\uparrow} \cdot \binom{N+1}{n_\downarrow}
\end{equation}
determinants are necessary to fully describe the wave function.
For a half-filled system ($N_\uparrow = N_\downarrow = (N+1)/2$)
with $N+1=140$ sites, this is approximately $\num{9e81}$
exceeding the number of protons in the observable universe $\bigO{\num{e80}}$. % Eddington number
As this is not treatable numerically,
we need to truncate a certain number of determinants with the smallest probabilities.
To save computational resources,
we want to find a new basis in which the probabilities
$|\alpha_i^2|$ in \zcref{eq:slater-decomposition}
decay faster than those of the star geometry
(further details in~\cite{Bi2019}).

Given a spin-orbital basis set $\{\ket{\phi_{i\sigma}}\}$
with their respective creator $c_{i\sigma}^\dag$~\cite{Bi2019},
the density matrix of the ground state is defined as
\begin{equation}
    n_{ij\sigma} = \sandwich{\psi_0}{c_{i\sigma}^\dag c_{j\sigma}}{\psi_0}.
\end{equation}
A commonly employed basis in quantum chemistry are the \emph{natural orbitals},
where the orbitals $\ket{\phi_{i\sigma}}$ are chosen such that
the aforementioned density matrix is diagonal $n_{ij\sigma} = \delta_{ij}n_{ij\sigma}$.
However,
a naive implementation of the natural orbitals will inevitably mix the original impurity
and bath sites transforming the local Coulomb interaction (\zcref{eq:anderson-interaction})
among multiple new sites,
losing locality~\cite{Lu2014,Lu2019}.
We therefore use the \emph{natural impurity orbitals}
which only rotates bath orbitals while keeping the impurity untouched.
This new geometry is shown in \zcref{subfig:geometry-natural-impurity-orbitals}.
The unchanged impurity $i$ is connected to a mirror site (labeled $m$) and two chains.
Following the convention of~\cite{Lu2014,Lu2019},
we call sites in the almost fully filled chain valence bath sites (labeled $v$),
and sites in the almost empty chain as conduction bath sites (labeled $c$).
Hopping between sites is again shown by lines.

\section{Restricted active space}%
\label{sec:ras}

\fe{NOTE:\@ I think RAS fits better than CI.}

Using the natural impurity orbitals (\zcref{sec:natural-impurity-orbitals}) allows us to
write the ground state in a basis which has optimal scaling behavior with respect to
the number of bath sites~\cite{Lu2019}.
However, the computational complexity still grows combinatorial with each added bath site.
To alleviate the scaling problem we employ the same restricted active space (RAS) method
as \citeauthor{Lu2019}~\cite{Lu2019}, which is sketched in \zcref{fig:aim-separation}.

\begin{figure}[ht]
    \centering
    \input{graphics/tikz/aim_separation.tex}
    \caption{
        Separation of the wave function into two components
        $\ket{\phi_I}$ and $\ket{\phi_{II}}$ denoted by two boxes.
    }%
    \label{fig:aim-separation}
\end{figure}

The full Hilbert space is projected onto a subspace that only contains
empty conduction sites $\ket{\mathbb{0}_c}$
and full valence sites $\ket{\mathbb{1}_v}$ for $l>L$.
The ground state can be written as
\begin{equation}
    \ket{\psi_0}
    =
    \ket{\phi_I} \otimes \ket{\mathbb{0}_c} \otimes \ket{\mathbb{1}_v}
    =
    \ket{\phi_I} \otimes \ket{\phi_{II}},
\end{equation}
where $\ket{\phi_I}$ is the exact ground state calculated by ED for some $L$
and $\ket{\phi_{II}} = \ket{\mathbb{0}_c} \otimes \ket{\mathbb{1}_v}$ is a reference state.

In the next step we loosen the restriction of empty conduction and full valence bath sites
in $\ket{\phi_{II}}$.
The $p=1$ projection allows one state to differ from the reference state:
Either one electron of $\ket{\phi_I}$ enters the empty conduction sites
or one electron from the full valence sites enters $\ket{\phi_I}$.
In the $p=2$ projection two states are allowed to differ.
This allows for one of the following possibilities for $\ket{\phi_{II}}$:
Two electrons in the conduction bath sites $c_l$,
two holes in the valence bath sites $v_l$,
or one electron in the conduction bath sites $c_l$
and one hole in the valence bath sites $v_l$ ($l\ge L$).

\section{Lanczos algorithm}%
\label{sec:lanczos-algorithm}

The Lanczos algorithm~\cite{Lanczos1950} can be used to approximate the extremal eigenvalues
of a hermitian $n\times n$ matrix.
In our case we are interested in the ground state and low energy excitations of a
given Hamiltonian $H$ (\zcref{eq:impurity-Hamiltonian}).
The method is especially useful if $H$ is sparse and too large to decompose fully.
It is based on a Krylov basis
\begin{equation}
    \mathcal{K}^M(H, \vec{q}) = \spn\{\vec{q}, H\vec{q}, H^2\vec{q}, \ldots, H^{M-1}\vec{q}\}
\end{equation}
for a given vector $\vec{q}$.
Typically, the value $M$ is very small compared to the matrix size: $M \ll n$.
Instead of a simple power iteration, the Lanczos algorithm is described by the
following recurrence relation
\begin{equation}
    b_j\vec{q}_{j+1} = H\vec{q}_j - a_j\vec{q}_j - b_{j-1}\vec{q}_{j-1}
    \label{eq:Lanczos-recurrence}
\end{equation}
with a normalized starting vector $\vec{q}_1$ and $\vec{q}_0 = \vec{0}$.
The coefficients are chosen such that each Lanczos vector $\vec{q}_j$ is orthonormal to each other
\begin{equation}
    a_j = \vec{q}_j^\dag H \vec{q}_j,
    \qquad
    b_j = \vec{q}_{j+1}^\dag H \vec{q}_j.
\end{equation}
For numerical stability~\cite{Paige1972, Paige1976}
we instead calculate the coefficients as
\begin{equation}
    a_j = \vec{q}_j^\dag(H \vec{q}_j - \beta_{j-1}\vec{q}_{j-1}),
    \qquad
    b_j = \norm{H\vec{q}_j - \alpha\vec{q}_j -  \beta_{j-1}\vec{q}_{j-1}}.
\end{equation}
From this relation we can create the tridiagonal matrix
\begin{equation}
    T
    =
    \begin{pmatrix}
        a_1 & b_1 &        &         &         \\
        b_1 & a_2 & b_2    &         &         \\
            & b_2 & a_3    & \ddots  &         \\
            &     & \ddots & \ddots  & b_{M-1} \\
            &     &        & b_{M-1} & a_M
    \end{pmatrix}
    \label{eq:tridiagonal-scalar}
\end{equation}
and matrix collecting all Lanczos vectors
\begin{equation}
    Q = (\vec{q}_1, \vec{q}_2, \ldots, \vec{q}_M).
\end{equation}
Rewriting \zcref{eq:Lanczos-recurrence} in matrix form and rearranging results in $T = Q^\dag H Q$,
which means that $T$ is the orthogonal projection of $H$ onto
the subspace $\mathcal{K}^M(H, \vec{q}_1)$~\cite{Cullum1985}.

\subsection{Block Lanczos}

Instead of calculating only one vector $\vec{q}_j$ in each step,
one can calculate $p$ vectors simultaneously.
We define
\begin{equation}
    Q_1 = (\vec{q}_1^{(1)}, \vec{q}_1^{(2)}, \ldots, \vec{q}_1^{(p)})
\end{equation}
to be an $n\times p$ orthonormal block of starting vectors
and $Q_0 = \mathbb{0}_{n\times q}$.
Then the recurrence relation (\zcref{eq:Lanczos-recurrence}) can be rewritten as
\begin{equation}
    Q_{j+1} B_j = H Q_j - Q_j A_j - Q_{j-1} B_{j-1}^\dag,
    \label{eq:block-Lanczos-recurrence}
\end{equation}
with $A_j$, $B_j$ matrices of size $p\times p$ chosen such that each block $Q_j$ is orthonormal
to each other.
The block tridiagonal matrix of size $Mp\times Mp$ is written as
\begin{equation}
    T
    =
    \begin{pmatrix}
        A_1 & B_1^\dag &          &         &              \\
        B_1 & A_2      & B_2^\dag &         &              \\
            & B_2      & A_3      & \ddots  &              \\
            &          & \ddots   & \ddots  & B_{M-1}^\dag \\
            &          &          & B_{M-1} & A_M
    \end{pmatrix}.
    \label{eq:tridiagonal-block}
\end{equation}
For the calculation for $B_j$ one needs to orthonormalize
\begin{equation}
    \tilde Q_{j+1} = H Q_j - Q_j A_j - Q_{j-1} B_{j-1}^\dag,
\end{equation}
which is not unique.
For instance, a QR decomposition $Q_{j+1} B_j = \tilde Q_{j+1}$
results in an upper triangular matrix $B_j$
which gives $T$ a compactly banded structure~\cite{Cullum1985, Golub2013}.
In our work however, we use symmetric LÃ¶wdin orthonormalization~\cite{Lowdin1950, Brass2021}
which is based on the singular value decomposition
$\tilde Q_{j+1} = U \Sigma V^\dag$.
We define the overlap matrix as
\begin{equation}
    S \coloneqq \tilde Q_{j+1}^\dag \tilde Q_{j+1} = V \Sigma^2 V^\dag
\end{equation}
and its roots as
\begin{equation}
    S^{1/2} = V \Sigma V^\dag,
    \qquad
    S^{-1/2} = V \Sigma^{-1} V^\dag.
\end{equation}
The resulting vectors are then
\begin{align}
    Q_{j+1} & = \tilde Q_{j+1} S^{-1/2} \qquad \text{and} \\
    B_j     & = S^{1/2}.
\end{align}
We use this method as it guarantees hermiticity in the off-diagonal blocks $B_j^\dag = B_j$
albeit losing the compactly banded structure for $T$.
If $\tilde Q_j$ is rank-deficient,
this method can still be applied~\cite{Brass2021} by only inverting the block of
non-vanishing singular values
\begin{equation}
    \Sigma =
    \begin{pmatrix}
        \Sigma_i \neq 0 & 0 \\
        0               & 0
    \end{pmatrix}
    \qquad
    \Sigma^{-1} =
    \begin{pmatrix}
        \Sigma_i^{-1} & 0 \\
        0             & 0
    \end{pmatrix},
\end{equation}
still guaranteeing orthogonality against previous states $Q_i^\dag Q_j = \mathbb{0}_{q\times q}$
for $i \in \{1,\ldots,j-1\}$~\cite{Golub2013}.

\section{Correlators}%
\label{sec:correlators}

The retarded correlator for two fermionic operators $A, B$ is defined as
\begin{equation}
    C(t) = -\mi \Theta(t) \expval{\acomm{A(t)}{B}},
    \label{eq:correlator-time}
\end{equation}
with the step function $\Theta$ and anticommutator $\acomm{\cdot}{\cdot}$.
$A(t) = \me^{\mi H t} A \me^{-\mi H t}$ is given in the Heisenberg picture.
At zero temperature $T=0$, the expectation value is evaluated on the ground state
$\expval{\,\cdot\,} = \sandwich{\psi_0}{\,\cdot\,}{\psi_0}$ only.
Following the notation of~\cite{Bulla1998,Kugler2022},
we will denote the Fourier transform as
\begin{equation}
    C_\omega
    \coloneq
    \lim_{\delta\to0^+}
    \int_{-\infty}^\infty\! \md t\> \me^{\mi (\omega + \mi\delta) t} C(t)
    \eqcolon
    \dangle{A}{B}{\omega}.
\end{equation}
Furthermore,
we split this expression into two components $C_\omega = C^+_\omega + C^-_\omega$ with
\begin{subequations}
    \begin{align}
        C^+_\omega
         & =
        \expval*{A \frac{1}{\omega + \mi0^+ - (H - E_0)} B}
        =
        \sum_n \frac{\sandwich{\psi_0}{A}{n}\sandwich{n}{B}{\psi_0}}{\omega + \mi0^+ - (E_n - E_0)}, \\
        C^-_\omega
         & =
        \expval*{B \frac{1}{\omega + \mi0^+ + (H - E_0)} A}
        =
        \sum_n \frac{\sandwich{\psi_0}{B}{n}\sandwich{n}{A}{\psi_0}}{\omega + \mi0^+ + (E_n - E_0)}.
    \end{align}
    \label{eq:correlator-frequency} % chktex 24
\end{subequations}
The sum is over a complete basis $H\ket{n} = E_n\ket{n}$ with ground state energy $E_0$.
A derivation is given in \zcref{app:fourier-transform}.
The problem however is the exponential algorithmic complexity:
For $N$ sites (bath and impurity), the number of all possible states scales as $O(4^N)$
limiting exact diagonalization (ED) to $N=O(10)$ sites.

For the choice $A=d_\sigma, B=d_\sigma^\dag$ the correlator describes
the propagation of an electron/hole in the system and is called Green's function $G_\omega$.

\subsection{Representation}

Using the (block) Lanczos algorithm we can represent (block) correlators as the first component
of the inverse of our (block) tridiagonal matrix $T$~\cite{Lu2014},
see \zcref{eq:tridiagonal-scalar, eq:tridiagonal-block}
\begin{equation}
    C_\omega
    \propto
    [(\omega + \mi0^+ - T)^{-1}]_{11},
\end{equation}
where $\omega + \mi0^+ \wedgeq (\omega + \mi0^+)\mathbb{1}$ is a shorthand notation
for a diagonal matrix.
Using the Schur complement~\cite{Schur1917} this can be written as a continued fraction
\begin{equation}
    C_\omega
    =
    B_0\frac{1}{\omega + \mi0^+ - A_1 - B_1\frac{1}{\omega + \mi0^+ - A_2 - \ldots}B_1}B_0,
\end{equation}
with $\frac{1}{D} \wedgeq D^{-1}$ meant as the matrix inverse.
$B_0$ normalizes the initial state of
the block Lanczos routine.
In contrast to \quanty~\cite{Ackermann2024} we always keep our matrices $B_i$ hermitian,
even if they are rank-deficient.
In the scalar case, all matrices $A_j$, $B_j$ are replaced by
their scalar counterpart $a_j$, $b_j$ respectively.
We will call this the \emph{continued fraction} representation.

Diagonalizing the matrix $T$ instead gives us a sum of poles:
\begin{equation}
    C_\omega
    =
    \sum_{i=1}^M \frac{W_i}{\omega + \mi0^+ - \epsilon_i},
    \label{eq:correlator-sum}
\end{equation}
where the matrix $W_i$ is again replaced by the scalar $w_i$ for the non-block version.
In order for a (block) correlator to represent physical quantities,
$W_i$ must be positive semidefinite or
$w_i$ positive.

Only diagonalizing from the second entry of $T$ onwards gives us the \emph{Anderson representation}
\begin{equation}
    C_\omega
    =
    B_0\frac{1}{\omega + \mi0^+ - A_1 - \sum_{j=2}^M \frac{W_j}{\omega + \mi0^+ - \epsilon_j}}B_0.
    \label{eq:correlator-anderson}
\end{equation}
A detailed explanation on how to switch between these representations is given in~\cite{Lu2014}.

\subsection{Broadening and spectra}

Given a correlator $C_\omega$ the corresponding spectral part is defined as
\begin{equation}
    A_\omega \coloneq -\frac{1}{\muppi}\Im C_\omega,
\end{equation}
which is easy to calculate if it is given as a sum of poles \zcref{eq:correlator-sum}:
\begin{equation}
    A_\omega = \sum_{i=1}^m w_i \delta(\omega - \epsilon_i).
    \label{eq:spectral-sum}
\end{equation}
The real and imaginary part of a correlator are not independent
but related by Kramers-Kronig transformations (Hilbert transform)
\begin{subequations}
    \begin{align}
        \Re C_\omega
         & =
        - \frac{1}{\muppi} \mathcal{P}\! \int_{-\infty}^\infty\! \md\omega'
        \frac{\Im C_{\omega'}}{\omega - \omega'}
        \label{eq:kramers-kronig-real} \\
        \Im C_\omega
         & =
        \phantom{-} \frac{1}{\muppi} \mathcal{P}\! \int_{-\infty}^\infty\! \md\omega'
        \frac{\Re C_{\omega'}}{\omega - \omega'}.
        \label{eq:kramers-kronig-imag}
    \end{align}
\end{subequations}

Thus, we can broaden our delta-peaks from \zcref{eq:spectral-sum}
for the imaginary part and obtain the real part through \zcref{eq:kramers-kronig-real}.
We will denote the broadened correlator as $C_z$
to contrast it against $C_\omega$ which has no broadening.
In this work we will use the following three schemes:
\begin{enumerate}[(i)]
    \item Lorentzian broadening characterized by $\delta$:%
          \label{item:lorentzian}
          \begin{equation}
              \delta(\omega - \omega_0)
              \longrightarrow
              \frac{1}{\muppi}\frac{\delta}{(\omega - \omega_0)^2 + \delta^2}
          \end{equation}
    \item Gaussian broadening characterized by $\sigma$:%
          \label{item:gaussian}
          \begin{equation}
              \delta(\omega - \omega_0)
              \longrightarrow
              \frac{1}{\sqrt{2\muppi \sigma^2}}\exp\left(-\frac{(\omega - \omega_0)^2}{2\sigma^2}\right)
          \end{equation}
    \item logarithmic Gaussian characterized by $b$~\cite{Bulla2008}:%
          \label{item:logarithmic-gaussian}
          \begin{equation}
              \delta(\omega - \omega_0)
              \longrightarrow
              \Theta(\omega\omega_0)\frac{\me^{-b^2/4}}{b\omega_0\sqrt{\muppi}}\exp\left(-\frac{(\ln\omega-\ln\omega_0)^2}{b^2}\right)
          \end{equation}
\end{enumerate}

\begin{figure}[ht]
    \centering
    \input{graphics/tikz/broadening.tex}
    \caption{
        Spectral part of a correlator
        $C_\omega = \frac{1}{\omega + \mi0^+ - 0.25} + \frac{0.5}{\omega + \mi0^+ - 1}$
        using various broadening schemes.
    }%
    \label{fig:broadening}
\end{figure}

A comparison of these broadenings is given in \zcref{fig:broadening}.
The Lorentzian and Gaussian spectra consist of symmetric peaks
with the former decaying slower compared to the latter.
The peaks generated by the logarithmic Gaussian are asymmetric
and sharper if the pole is closer to $\omega=0$.
As all poles are at located at $\omega>0$,
the spectrum of the log Gaussian vanishes for $\omega\le0$.

\section{Self-energy}%
\label{sec:self-energy}

As mentioned in the previous section,
the Green's function $G_\omega$ describes the propagation of an electron/hole in our system.
If our system is non-interacting ($U=0$ in \zcref{eq:anderson-interaction}),
we call it the non-interacting Green's function $G_{0, \omega}$.
The quantity that connects these two objects is the self-energy defined by the Dyson equation
\fe{NOTE:\@ I do not want to introduce Feynman diagrams and irreducibility as
    they will not be used in this work.}
\begin{equation}
    \Sigma_\omega = (G_{0, \omega})^{-1} - (G_\omega)^{-1}.
    \label{eq:dyson}
\end{equation}

In~\cite{Lu2014},
this equation was used to represent the self-energy by the constant Hartree term $\Sigma^\mH$
and a sum of poles
\begin{equation}
    \Sigma_\omega = \Sigma^\mH + \sum_j \frac{w_j}{\omega + \mi0^+ - \epsilon_j}.
    \label{eq:self-energy-sum-of-poles}
\end{equation}
For the self-energy to be physical, all weights must be positive.
On a system with finite bath sites and floating-point arithmetic however,
this was violated and poles with negative weight had to be merged into neighbors
such that only positive weight remained.

Therefore, we calculate the self-energy using the symmetric improved estimator
$\Sigma^\mIFG_\omega$~\cite{Kugler2022}
which will be summarized in the following:
We introduce the auxiliary operator
\begin{equation}
    q_\sigma = \comm{d_\sigma}{H_\mathrm{int}}
\end{equation}
for the Anderson impurity model (\zcref{sec:anderson-impurity-model}),
allowing us to calculate the Hartree term directly
\begin{equation}
    \Sigma^\mH = \expval{\acomm{q^\dag_\sigma}{d^{\pdag}_\sigma}}.
\end{equation}
We then employ a quadratic shift
\begin{equation}
    \tilde q_\sigma = q_\sigma - \Sigma^\mH d_\sigma
    \label{eq:quadratic-shift}
\end{equation}
and obtain four correlation functions
\begin{subequations}
    \begin{alignat}{2}
        G_\omega
         & =
        \dangle{d^{\pdag}_\sigma}{d_{\sigma}^\dag}{\omega},
         &
        \qquad
        I_\omega
         & =
        \dangle{\tilde q^{\pdag}_\sigma}{\tilde q_{\sigma}^\dag}{\omega}, \\
        F^\mL_\omega
         & =
        \dangle{\tilde q^{\pdag}_\sigma}{d_{\sigma}^\dag}{\omega},
         &
        \qquad
        F^\mR_\omega
         & =
        \dangle{d^{\pdag}_\sigma}{\tilde q_{\sigma}^\dag}{\omega}.
    \end{alignat}
\end{subequations}
The self-energy is computed as
\begin{equation}
    \Sigma^\mIFG_\omega
    =
    \Sigma^\mH + I_\omega - F^\mL_\omega (G_\omega)^{-1} F^\mR_\omega.
\end{equation}
Concretely, we first calculate the components of our block correlator as
\begin{subequations}
    \begin{align}
        C^+_\omega
         & =
        \sandwich*
        {\psi_0}
        {
            \begin{pmatrix}
                \tilde q^{\pdag}_\sigma \\
                d^{\pdag}_\sigma
            \end{pmatrix}
            \frac{1}{\omega + \mi0^+ - (H - E_0)}
            \begin{pmatrix}
                \tilde q^\dag_\sigma & d^\dag_\sigma
            \end{pmatrix}
        }
        {\psi_0}
        =
        \begin{pmatrix}
            I^+_\omega      & F^{\mL+}_\omega \\
            F^{\mR+}_\omega & G^+_\omega
        \end{pmatrix}, \\
        C^-_\omega
         & =
        \sandwich*
        {\psi_0}
        {
            \begin{pmatrix}
                \tilde q^\dag_\sigma \\
                d^\dag_\sigma
            \end{pmatrix}
            \frac{1}{\omega + \mi0^+ + (H - E_0)}
            \begin{pmatrix}
                \tilde q^{\pdag}_\sigma & d^{\pdag}_\sigma
            \end{pmatrix}
        }
        {\psi_0}
        =
        \begin{pmatrix}
            I^-_\omega      & F^{\mR-}_\omega \\
            F^{\mL-}_\omega & G^-_\omega
        \end{pmatrix}
    \end{align}
\end{subequations}
and add them together
\begin{equation}
    C_\omega
    =
    C^+_\omega + (C^-_\omega)^\top
    =
    \begin{pmatrix}
        I_\omega       & F^{\mL}_\omega \\
        F^{\mR}_\omega & G_\omega
    \end{pmatrix}.
\end{equation}
In~\cite{Kugler2022} it was noted that $F^{\mR}_\omega = (F^{\mL}_\omega)^\dag$
might be violated numerically.
We do not have this problem as $C_\omega$ is hermitian by construction.

Given each correlator as a sum of poles,~\citeauthor{Kugler2022}~\cite{Kugler2022} broadened
each correlator and calculated the broadened self-energy $\Sigma_z$.
In this work we instead calculate the self-energy on the real axis
using the Schur complement~\cite{Schur1917}
\fe{TODO:\@ credit Aleksandrs} %TODO: credit Aleksandrs
\begin{equation}
    \Sigma_\omega = \Sigma^\mH + \left([(C_\omega)^{-1}]_{11}\right)^{-1}.
\end{equation}
To invert our block correlation function, we first bring it to
the Anderson representation (\zcref{eq:correlator-anderson}):
\begin{equation}
    C_\omega = B\frac{1}{\omega + \mi0^+ - A - D_\omega}B,
\end{equation}
with matrices $A$, $B$ and a block sum of poles $D_\omega$.
The scaling matrix $B$ contains the square root of the zeroth moments,
e.g.\ its first element $B_{11} = U/2$ at half-filling.
Due to the quadratic shift (\zcref{eq:quadratic-shift}), it is diagonal.
The Schur complement is then
\begin{equation}
    \left([(C_\omega)^{-1}]_{11}\right)^{-1}
    =
    B_{11} \frac{1}{\omega + \mi0^+ - A_{11} - (D_\omega)_{11}} B_{11}.
\end{equation}
Diagonalizing this expression gives us the self-energy in the same form as
\zcref{eq:self-energy-sum-of-poles}.
Contrasting against \zcref{eq:dyson},
all pole weights are positive by construction
and no merging of negative weight into neighbors is necessary.

\section{Ground state}

In order to calculate correlators and expectation values listed in
\zcref{sec:correlators, sec:self-energy} at $T=0$,
one first needs to obtain the ground state of a given impurity Hamiltonian $H$
(\zcref{eq:impurity-Hamiltonian}).
As an initial guess we take the state with all valence bath sites $v_k$ filled in combination with
a singlet state in the impurity $i$ and mirror site $m$
(the filling of each site is sketched in \zcref{subfig:geometry-natural-impurity-orbitals}):
\begin{equation}
    \ket*{\psi_0^{(1)}}
    =
    \frac{1}{\sqrt{2}}
    \left(d^\dag_\uparrow m^\dag_\downarrow - d^\dag_\downarrow m^\dag_\uparrow\right)
    \prod_{k\sigma} v^\dag_{k\sigma}
    \ket{0}.
\end{equation}
Given this state, we can calculate an approximate ground state energy
\begin{equation}
    E_0^{(1)} = \sandwich*{\psi_0^{(1)}}{H}{\psi_0^{(1)}}
\end{equation}
and variance
\begin{equation}
    \var^{(1)}
    =
    \sandwich*{\psi_0^{(1)}}{\left(H - E_0^{(1)}\right)^2}{\psi_0^{(1)}}.
\end{equation}
As this approximation is not sufficient for calculations,
we employ the Lanczos method (\zcref{sec:lanczos-algorithm}) with restarting
as described in~\cite{Lu2014}:
Given an approximate ground state $\ket{\psi_0^{(i)}}$,
we calculate a new Krylov basis $\mathcal{K}^5(H, \ket{\psi_0^{(i)}})$ which is diagonalized.
From this, we calculate a new state $\ket{\psi_0^{(i+1)}}$
with a new ground state energy $E_0^{(i+1)}$
and variance $\var^{(i+1)}$.
This loop is repeated until the variance falls below a given tolerance
as it must vanish for a true eigenstate of $H$.

One should note that even if the variance is exactly zero for a state $\ket{\tilde\psi_0}$
in the RAS truncation (\zcref{sec:ras}),
this state is not a true eigenstate of the unrestricted Hamiltonian.
Applying $H$ on $\ket{\tilde\psi_0}$ without any restriction
will generate new states~\cite{Lu2014} that were not accounted for.
It is just that these state have (hopefully) such small weight allowing us to ignore them.

\section{DMFT}%
\label{sec:dmft}

As mentioned in \zcref{sec:hubbard-model},
the Hubbard model has no analytical solution in arbitrary dimensions $d$.
In the limit $d\to\infty$ however, it can be solved with
dynamical mean-field theory (DMFT)~\cite{Georges1996},
which takes a single lattice site as a representative
and averages all spacial fluctuations around it, only keeping time correlations
(hence the term \emph{dynamical mean-field}).

A given Hamiltonian is solved by a self-consistency loop,
which repeatedly maps between the Hubbard model and Anderson impurity model.
Given a Hubbard Hamiltonian, we can define its local Green's function
\begin{equation}
    G_{\mloc,\omega}
    =
    \frac{1}{V_\mBZ} \int_\mBZ \md\vec{k}\> G_{\vec{k}\omega}
    \approx
    \frac{1}{V_\mBZ} \int_\mBZ \md\vec{k}\> \frac{1}{\omega + \mi0^+ + \mu - \epsilon_{\vec{k}} - \Sigma_\omega},
    \label{eq:greens-function-local}
\end{equation}
where the approximation assumes that the lattice self-energy is purely local
($\Sigma_{\vec{k}\omega} \to \Sigma_\omega$).
DMFT then enforces that this Green's function coincides with the impurity Green's function
of the corresponding Anderson impurity model: $G_{\mloc,\omega} \equiv G_\omega$.
\fe{``$\equiv$'' or ``$\stackrel{!}{=}$'' better? Latter one raises line height.}

Rearranging the Dyson equation (\zcref{eq:dyson}) then gives us a non-interacting impurity
Green's function
\begin{align}
    (G_{0,\omega})^{-1}
     & =
    (G_{\mloc,\omega})^{-1} + \Sigma_\omega \\
     & =
    \omega + \mi0^+ + \mu - \epsilon - \Delta_\omega,
\end{align}
which is then rewritten into terms,
containing the impurity energy $\epsilon - \mu$ and hybridization function
\begin{equation}
    \Delta_\omega = \sum_{k\sigma} \frac{\abs{V_{k\sigma}}^2}{\omega +\mi0^+ - \epsilon_{k\sigma}}.
\end{equation}
Given these terms, we can write down the non-interacting Hamiltonian
of \zcref{eq:anderson-non-interacting}.
After adding the interacting term of \zcref{eq:anderson-interaction}, we can solve the impurity
Hamiltonian using the previously discussed solver,
yielding us a new impurity Green's function $G_\omega$
and self-energy $\Sigma_\omega$.
Subsequently, we use this impurity self-energy to
calculate a new lattice Green's function using \zcref{eq:greens-function-local},
closing our self-consistency loop.

For the special case of a lattice in infinite dimensions,
one can skip the calculation of the lattice Green's function
and directly update the hybridization~\cite{Lu2014}:
\begin{equation}
    \Delta_\omega = \Delta_{0}(\omega + \mu - \mu_0 - \Sigma_\omega),
\end{equation}
with a derivation given in \zcref{app:dmft-simplification}.

Due to the self-similarity present in the Bethe lattice,
the hybridization function is just a rescaled Green's function
\begin{equation}
    \Delta_\omega = \frac{D^2}{4} G_\omega.
\end{equation}
Notably,
the spectrum of the non-interacting hybridization function $-1/\muppi \Im \Delta_{0,\omega}$
is nothing more than a rescaled semicircular DOS \zcref{eq:dos-semicircle}.
